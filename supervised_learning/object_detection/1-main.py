#!/usr/bin/env python3

if __name__ == '__main__':
    import numpy as np
    Yolo = __import__('1-yolo').Yolo

    np.random.seed(0)
    anchors = np.array([[[116, 90], [156, 198], [373, 326]],
                        [[30, 61], [62, 45], [59, 119]],
                        [[10, 13], [16, 30], [33, 23]]])
    yolo = Yolo('../data/yolo.h5', '../data/coco_classes.txt', 0.6, 0.5, anchors)
    output1 = np.random.randn(13, 13, 3, 85)
    output2 = np.random.randn(26, 26, 3, 85)
    output3 = np.random.randn(52, 52, 3, 85)
    boxes, box_confidences, box_class_probs = yolo.process_outputs([output1, output2, output3], np.array([500, 700]))
    print('Boxes:', boxes)
    print('Box confidences:', box_confidences)
    print('Box class probabilities:', box_class_probs)
root@alexa-ml2:~/object_detection# ./1-main.py 
WARNING:tensorflow:No training configuration found in save file: the model was *not* compiled. Compile it manually.
Boxes: [array([[[[-2.13743365e+02, -4.85478868e+02,  3.05682061e+02,
           5.31534670e+02],
         [-6.28222336e+01, -1.13713822e+01,  1.56452678e+02,
           7.01966357e+01],
         [-7.00753664e+02, -7.99011810e+01,  7.77777040e+02,
           1.24440730e+02]],

                ...

        [[ 5.61142819e+02,  3.07685110e+02,  7.48124593e+02,
           6.41890468e+02],
         [ 5.80033260e+02,  2.88627445e+02,  7.62480440e+02,
           6.47683922e+02],
         [ 3.58437752e+02,  2.46899004e+02,  9.55713550e+02,
           7.08803200e+02]]]]), array([[[[-1.23432804e+01, -3.22999818e+02,  2.20307323e+01,
           3.46429534e+02],
         [-1.80604912e+01, -7.11557928e+00,  3.29117181e+01,
           3.76250584e+01],
         [-1.60588925e+02, -1.42683911e+02,  1.73612755e+02,
           1.73506691e+02]],

                ...

        [[ 6.68829175e+02,  4.87753124e+02,  6.82031480e+02,
           5.03135980e+02],
         [ 4.34438370e+02,  4.78337823e+02,  9.46316108e+02,
           5.09664332e+02],
         [ 6.22075514e+02,  4.82103466e+02,  7.35368626e+02,
           4.95580409e+02]]]]), array([[[[-2.69962831e+00, -7.76450289e-01,  1.24050569e+01,
           2.78936573e+00],
         [-4.22907727e+00, -1.06544368e+01,  1.17677684e+01,
           2.57860099e+01],
         [-7.89233952e+01, -2.81791298e+00,  8.90320793e+01,
           1.29705044e+01]],

                ...

        [[ 6.76849818e+02,  4.46289490e+02,  7.00081017e+02,
           5.41566130e+02],
         [ 6.66112867e+02,  4.81296831e+02,  7.28887543e+02,
           5.01093787e+02],
         [ 6.29818872e+02,  4.58019128e+02,  7.50570597e+02,
           5.32394185e+02]]]])]
Box confidences: [array([[[[0.86617546],
         [0.74162884],
         [0.26226237]],

                ...

        [[0.75932849],
         [0.53997516],
         [0.54609635]]]]), array([[[[0.56739016],
         [0.88809651],
         [0.58774731]],

                ...

        [[0.58788139],
         [0.3982885 ],
         [0.56051201]]]]), array([[[[0.73336558],
         [0.57887604],
         [0.59277021]],

                ...

        [[0.19774838],
         [0.69947049],
         [0.36158221]]]])]
Box class probabilities: [array([[[[0.27343225, 0.72113296, 0.46223277, ..., 0.6143566 ,
          0.177082  , 0.81581579],
         [0.40054928, 0.77249355, 0.55188134, ..., 0.17584277,
          0.76638851, 0.57857896],
         [0.66409448, 0.30929663, 0.33413323, ..., 0.53542882,
          0.42083943, 0.66630914]],

                ...

        [[0.48321664, 0.22789979, 0.6691948 , ..., 0.53945861,
          0.30098012, 0.72069712],
         [0.45435778, 0.68714784, 0.60871616, ..., 0.51156461,
          0.14100029, 0.38924579],
         [0.14533179, 0.91481357, 0.46558833, ..., 0.29158615,
          0.26098354, 0.6078719 ]]]]), array([[[[0.16748018, 0.74425493, 0.77271059, ..., 0.82238314,
          0.45290514, 0.35835817],
         [0.35157962, 0.88467242, 0.18324688, ..., 0.63359015,
          0.40203054, 0.48139226],
         [0.45924026, 0.81674653, 0.68472278, ..., 0.45661086,
          0.13878263, 0.58812507]],

                ...

        [[0.34600385, 0.2430844 , 0.82184407, ..., 0.64286074,
          0.2806551 , 0.10224861],
         [0.89692404, 0.22950708, 0.46779974, ..., 0.6787069 ,
          0.25042145, 0.63684789],
         [0.36853257, 0.67040213, 0.4840967 , ..., 0.4530742 ,
          0.20817072, 0.59335632]]]]), array([[[[0.5651767 , 0.5976206 , 0.38176215, ..., 0.27546563,
          0.31863509, 0.31522224],
         [0.34311079, 0.35702272, 0.52498233, ..., 0.67677487,
          0.13292343, 0.79922556],
         [0.31009487, 0.12745849, 0.45797284, ..., 0.20871353,
          0.60219055, 0.29796099]],

                ...

        [[0.24181667, 0.17739203, 0.77300902, ..., 0.59600114,
          0.3446732 , 0.75570862],
         [0.53289017, 0.31652626, 0.11990411, ..., 0.45424862,
          0.2372848 , 0.26196449],
         [0.40272803, 0.24201719, 0.80157031, ..., 0.2338579 ,
          0.18169015, 0.36450041]]]])]